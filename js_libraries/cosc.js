!function(t){"use strict";var e=t.fn,s=t.modules.Oscillator;function i(i){t.Object.call(this,1,i),e.fixAR(this);var c=this._;c.freq=t(440),c.osc1=new s(c.samplerate),c.osc2=new s(c.samplerate),c.osc1.step=c.cellsize,c.osc2.step=c.cellsize,c.tmp=new e.SignalArray(c.cellsize),c.beats=.5,this.once("init",n)}e.extend(i);var n=function(){this.wave||(this.wave="sin")},c=i.prototype;Object.defineProperties(c,{wave:{set:function(t){this._.osc1.setWave(t),this._.osc2.setWave(t)},get:function(){return this._.osc1.wave}},freq:{set:function(e){this._.freq=t(e)},get:function(){return this._.freq}},beats:{set:function(t){"number"==typeof t&&t>0&&(this._.beats=t)},get:function(){return this._.beats}}}),c.bang=function(){return this._.osc1.reset(),this._.osc2.reset(),this._.emit("bang"),this},c.process=function(t){var s=this._,i=this.cells[0];if(this.tickID!==t){this.tickID=t;var n,c=i.length,r=s.freq.process(t).cells[0][0],o=s.osc1,a=s.osc2,f=s.tmp;for(o.frequency=r-.5*s.beats,o.process(f),n=0;n<c;++n)i[n]=.5*f[n];for(a.frequency=r+.5*s.beats,a.process(f),n=0;n<c;++n)i[n]+=.5*f[n];e.outputSignalAR(this)}return this},e.register("cosc",i)}(timbre);